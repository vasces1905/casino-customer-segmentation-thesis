2025-07-28 15:59:22,112 - INFO - Logging to: FIXED_model_comparison_20250728_1559.log
2025-07-28 15:59:22,112 - INFO - Starting FIXED comprehensive model comparison...
2025-07-28 15:59:22,113 - INFO - Discovering trained harmonized RF models...
2025-07-28 15:59:22,114 - INFO - Discovered 4 trained periods: ['2022-H1', '2022-H2', '2023-H1', '2023-H2']
2025-07-28 15:59:22,114 - INFO - Processing period 2022-H1...
2025-07-28 15:59:24,363 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H1_v1_20250728_1145.pkl
2025-07-28 15:59:24,364 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:24,373 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:24,373 - INFO - Evaluating algorithms for period 2022-H1...
2025-07-28 15:59:24,373 - INFO - Loading COMPLETE training data for period 2022-H1...
2025-07-28 15:59:25,556 - INFO - Loaded 2326 customers with 23 base features for period 2022-H1
2025-07-28 15:59:25,558 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 15:59:25,558 - INFO - Creating engineered features to match training...
2025-07-28 15:59:25,584 - INFO - Complete dataset: 39 total features
2025-07-28 15:59:25,584 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:25,593 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 15:59:25,600 - WARNING - This may still impact RF performance!
2025-07-28 15:59:25,608 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 15:59:25,608 - INFO - Target distribution: {'NO_PROMOTION': 1744, 'GROWTH_TARGET': 279, 'LOW_ENGAGEMENT': 186, 'INTERVENTION_NEEDED': 116}
2025-07-28 15:59:25,608 - INFO - Current imbalance ratio: 27.09
2025-07-28 15:59:25,608 - INFO - Applying balanced resampling...
2025-07-28 15:59:25,609 - INFO -   NO_PROMOTION: 1869 -> 1744
2025-07-28 15:59:25,609 - INFO -   GROWTH_TARGET: 279 -> 279
2025-07-28 15:59:25,609 - INFO -   LOW_ENGAGEMENT: 109 -> 186
2025-07-28 15:59:25,610 - INFO -   INTERVENTION_NEEDED: 69 -> 116
2025-07-28 15:59:25,612 - INFO - Balanced dataset size: 2325
2025-07-28 15:59:25,613 - INFO - New label distribution:
promo_label
NO_PROMOTION           1744
GROWTH_TARGET           279
LOW_ENGAGEMENT          186
INTERVENTION_NEEDED     116
Name: count, dtype: int64
2025-07-28 15:59:25,619 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:25,619 - INFO - Balanced encoded distribution: [ 279  116  186 1744]
2025-07-28 15:59:25,619 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 15:59:25,620 - INFO - Final feature matrix shape: (2325, 31)
2025-07-28 15:59:25,620 - INFO - Expected features: 31
2025-07-28 15:59:25,620 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:25,620 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:37,210 - INFO - Train set: 5580 samples
2025-07-28 15:59:37,210 - INFO - Test set: 465 samples
2025-07-28 15:59:37,211 - INFO - Test distribution: [ 56  23  37 349]
2025-07-28 15:59:37,211 - INFO - Evaluating trained Random Forest...
2025-07-28 15:59:37,390 - INFO - Training Decision_Tree...
2025-07-28 15:59:37,437 - INFO - Training Logistic_Regression...
2025-07-28 15:59:37,593 - INFO - Training K_Nearest_Neighbors...
2025-07-28 15:59:37,618 - INFO - Training Naive_Bayes...
2025-07-28 15:59:37,633 - INFO - Training Support_Vector_Machine...
2025-07-28 15:59:38,839 - INFO - Processing period 2022-H2...
2025-07-28 15:59:38,940 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H2_v1_20250728_1201.pkl
2025-07-28 15:59:38,941 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:38,941 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:38,944 - INFO - Evaluating algorithms for period 2022-H2...
2025-07-28 15:59:38,944 - INFO - Loading COMPLETE training data for period 2022-H2...
2025-07-28 15:59:39,016 - INFO - Loaded 3806 customers with 23 base features for period 2022-H2
2025-07-28 15:59:39,018 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 15:59:39,018 - INFO - Creating engineered features to match training...
2025-07-28 15:59:39,032 - INFO - Complete dataset: 39 total features
2025-07-28 15:59:39,032 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:39,034 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 15:59:39,048 - WARNING - This may still impact RF performance!
2025-07-28 15:59:39,056 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 15:59:39,056 - INFO - Target distribution: {'NO_PROMOTION': 2854, 'GROWTH_TARGET': 456, 'LOW_ENGAGEMENT': 304, 'INTERVENTION_NEEDED': 190}
2025-07-28 15:59:39,056 - INFO - Current imbalance ratio: 21.01
2025-07-28 15:59:39,056 - INFO - Applying balanced resampling...
2025-07-28 15:59:39,057 - INFO -   NO_PROMOTION: 3025 -> 2854
2025-07-28 15:59:39,058 - INFO -   GROWTH_TARGET: 456 -> 456
2025-07-28 15:59:39,059 - INFO -   LOW_ENGAGEMENT: 181 -> 304
2025-07-28 15:59:39,059 - INFO -   INTERVENTION_NEEDED: 144 -> 190
2025-07-28 15:59:39,062 - INFO - Balanced dataset size: 3804
2025-07-28 15:59:39,063 - INFO - New label distribution:
promo_label
NO_PROMOTION           2854
GROWTH_TARGET           456
LOW_ENGAGEMENT          304
INTERVENTION_NEEDED     190
Name: count, dtype: int64
2025-07-28 15:59:39,069 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:39,069 - INFO - Balanced encoded distribution: [ 456  190  304 2854]
2025-07-28 15:59:39,069 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 15:59:39,069 - INFO - Final feature matrix shape: (3804, 31)
2025-07-28 15:59:39,069 - INFO - Expected features: 31
2025-07-28 15:59:39,070 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:39,070 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:39,108 - INFO - Train set: 9132 samples
2025-07-28 15:59:39,108 - INFO - Test set: 761 samples
2025-07-28 15:59:39,108 - INFO - Test distribution: [ 91  38  61 571]
2025-07-28 15:59:39,108 - INFO - Evaluating trained Random Forest...
2025-07-28 15:59:39,369 - INFO - Training Decision_Tree...
2025-07-28 15:59:39,478 - INFO - Training Logistic_Regression...
2025-07-28 15:59:39,872 - INFO - Training K_Nearest_Neighbors...
2025-07-28 15:59:39,967 - INFO - Training Naive_Bayes...
2025-07-28 15:59:39,996 - INFO - Training Support_Vector_Machine...
2025-07-28 15:59:49,223 - INFO - Processing period 2023-H1...
2025-07-28 15:59:50,051 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H1_v1_20250728_1204.pkl
2025-07-28 15:59:50,052 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:50,053 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:50,074 - INFO - Evaluating algorithms for period 2023-H1...
2025-07-28 15:59:50,074 - INFO - Loading COMPLETE training data for period 2023-H1...
2025-07-28 15:59:50,352 - INFO - Loaded 6646 customers with 23 base features for period 2023-H1
2025-07-28 15:59:50,356 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 15:59:50,356 - INFO - Creating engineered features to match training...
2025-07-28 15:59:50,412 - INFO - Complete dataset: 39 total features
2025-07-28 15:59:50,414 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 15:59:50,421 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 15:59:50,453 - WARNING - This may still impact RF performance!
2025-07-28 15:59:50,499 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 15:59:50,500 - INFO - Target distribution: {'NO_PROMOTION': 4984, 'GROWTH_TARGET': 797, 'LOW_ENGAGEMENT': 531, 'INTERVENTION_NEEDED': 332}
2025-07-28 15:59:50,501 - INFO - Current imbalance ratio: 15.60
2025-07-28 15:59:50,535 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:50,535 - INFO - Balanced encoded distribution: [ 797  339  332 5178]
2025-07-28 15:59:50,536 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 15:59:50,537 - INFO - Final feature matrix shape: (6646, 31)
2025-07-28 15:59:50,537 - INFO - Expected features: 31
2025-07-28 15:59:50,538 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:50,538 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 15:59:50,693 - INFO - Train set: 16568 samples
2025-07-28 15:59:50,694 - INFO - Test set: 1330 samples
2025-07-28 15:59:50,695 - INFO - Test distribution: [ 160   68   66 1036]
2025-07-28 15:59:50,695 - INFO - Evaluating trained Random Forest...
2025-07-28 15:59:51,328 - INFO - Training Decision_Tree...
2025-07-28 15:59:51,892 - INFO - Training Logistic_Regression...
2025-07-28 15:59:54,192 - INFO - Training K_Nearest_Neighbors...
2025-07-28 15:59:54,327 - INFO - Training Naive_Bayes...
2025-07-28 15:59:54,368 - INFO - Training Support_Vector_Machine...
2025-07-28 16:00:18,776 - INFO - Processing period 2023-H2...
2025-07-28 16:00:19,728 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H2_v1_20250728_1206.pkl
2025-07-28 16:00:19,728 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 16:00:19,729 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 16:00:19,747 - INFO - Evaluating algorithms for period 2023-H2...
2025-07-28 16:00:19,747 - INFO - Loading COMPLETE training data for period 2023-H2...
2025-07-28 16:00:20,062 - INFO - Loaded 15101 customers with 23 base features for period 2023-H2
2025-07-28 16:00:20,066 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 16:00:20,066 - INFO - Creating engineered features to match training...
2025-07-28 16:00:20,098 - INFO - Complete dataset: 39 total features
2025-07-28 16:00:20,099 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 16:00:20,102 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 16:00:20,125 - WARNING - This may still impact RF performance!
2025-07-28 16:00:20,162 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 16:00:20,162 - INFO - Target distribution: {'NO_PROMOTION': 11325, 'GROWTH_TARGET': 1812, 'LOW_ENGAGEMENT': 1208, 'INTERVENTION_NEEDED': 755}
2025-07-28 16:00:20,162 - INFO - Current imbalance ratio: 19.96
2025-07-28 16:00:20,189 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 16:00:20,189 - INFO - Balanced encoded distribution: [ 1812   598   755 11936]
2025-07-28 16:00:20,190 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 16:00:20,191 - INFO - Final feature matrix shape: (15101, 31)
2025-07-28 16:00:20,191 - INFO - Expected features: 31
2025-07-28 16:00:20,191 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 16:00:20,192 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 16:00:20,377 - INFO - Train set: 38192 samples
2025-07-28 16:00:20,377 - INFO - Test set: 3021 samples
2025-07-28 16:00:20,378 - INFO - Test distribution: [ 362  120  151 2388]
2025-07-28 16:00:20,378 - INFO - Evaluating trained Random Forest...
2025-07-28 16:00:20,713 - INFO - Training Decision_Tree...
2025-07-28 16:00:21,757 - INFO - Training Logistic_Regression...
2025-07-28 16:00:26,287 - INFO - Training K_Nearest_Neighbors...
2025-07-28 16:00:27,077 - INFO - Training Naive_Bayes...
2025-07-28 16:00:27,142 - INFO - Training Support_Vector_Machine...
2025-07-28 16:03:31,665 - ERROR - Comparison failed: 'charmap' codec can't encode character '\u2192' in position 40: character maps to <undefined>
