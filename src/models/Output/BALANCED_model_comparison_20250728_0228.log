2025-07-28 02:28:06,953 - INFO - Logging to: BALANCED_model_comparison_20250728_0228.log
2025-07-28 02:28:06,953 - INFO - Starting BALANCED comprehensive model comparison...
2025-07-28 02:28:06,954 - INFO - Discovering trained harmonized RF models...
2025-07-28 02:28:06,955 - INFO - Discovered 4 trained periods: ['2022-H1', '2022-H2', '2023-H1', '2023-H2']
2025-07-28 02:28:06,955 - INFO - Processing period 2022-H1...
2025-07-28 02:28:07,339 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H1_v1_20250728_0213.pkl
2025-07-28 02:28:07,339 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:07,350 - INFO - Feature count: 22
2025-07-28 02:28:07,350 - INFO - Evaluating algorithms with BALANCED data for period 2022-H1...
2025-07-28 02:28:07,351 - INFO - Loading raw training data for period 2022-H1...
2025-07-28 02:28:08,220 - INFO - Loaded 2326 customers for period 2022-H1
2025-07-28 02:28:08,221 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 02:28:08,223 - INFO - Applying BALANCED preprocessing for comparison...
2025-07-28 02:28:08,226 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 02:28:08,227 - INFO - Target distribution: {'NO_PROMOTION': 1744, 'GROWTH_TARGET': 279, 'LOW_ENGAGEMENT': 186, 'INTERVENTION_NEEDED': 116}
2025-07-28 02:28:08,227 - INFO - Current imbalance ratio: 27.09
2025-07-28 02:28:08,227 - INFO - Applying balanced resampling...
2025-07-28 02:28:08,228 - INFO -   NO_PROMOTION: 1869 -> 1744
2025-07-28 02:28:08,228 - INFO -   GROWTH_TARGET: 279 -> 279
2025-07-28 02:28:08,229 - INFO -   LOW_ENGAGEMENT: 109 -> 186
2025-07-28 02:28:08,229 - INFO -   INTERVENTION_NEEDED: 69 -> 116
2025-07-28 02:28:08,232 - INFO - Balanced dataset size: 2325
2025-07-28 02:28:08,233 - INFO - New label distribution:
promo_label
NO_PROMOTION           1744
GROWTH_TARGET           279
LOW_ENGAGEMENT          186
INTERVENTION_NEEDED     116
Name: count, dtype: int64
2025-07-28 02:28:08,238 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:08,239 - INFO - Balanced encoded distribution: [ 279  116  186 1744]
2025-07-28 02:28:08,239 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 02:28:08,239 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:08,240 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:08,241 - INFO - Balanced train set: 1860 samples
2025-07-28 02:28:08,242 - INFO - Balanced test set: 465 samples
2025-07-28 02:28:08,242 - INFO - Test distribution: [ 56  23  37 349]
2025-07-28 02:28:08,242 - INFO - Evaluating trained Random Forest on BALANCED data...
2025-07-28 02:28:08,354 - INFO - Random Forest: Accuracy=0.0796, F1=0.0117, ROC_AUC=0.5052149834325091
2025-07-28 02:28:08,354 - INFO - RF Prediction distribution: [  0   0 465]
2025-07-28 02:28:08,355 - INFO - Actual test distribution: [ 56  23  37 349]
2025-07-28 02:28:08,355 - INFO - Training Decision_Tree on balanced data...
2025-07-28 02:28:08,365 - INFO - Decision_Tree: Accuracy=0.8581, F1=0.8591, ROC_AUC=0.9093631351350304
2025-07-28 02:28:08,365 - INFO - Training Logistic_Regression on balanced data...
2025-07-28 02:28:08,461 - INFO - Logistic_Regression: Accuracy=0.7419, F1=0.7616, ROC_AUC=0.875050895672891
2025-07-28 02:28:08,461 - INFO - Training K_Nearest_Neighbors on balanced data...
2025-07-28 02:28:12,867 - INFO - K_Nearest_Neighbors: Accuracy=0.8774, F1=0.8654, ROC_AUC=0.9339904670866707
2025-07-28 02:28:12,867 - INFO - Training Naive_Bayes on balanced data...
2025-07-28 02:28:12,878 - INFO - Naive_Bayes: Accuracy=0.7677, F1=0.7566, ROC_AUC=0.8433417247733775
2025-07-28 02:28:12,879 - INFO - Training Support_Vector_Machine on balanced data...
2025-07-28 02:28:13,304 - INFO - Support_Vector_Machine: Accuracy=0.8280, F1=0.8417, ROC_AUC=0.9507067659159147
2025-07-28 02:28:13,304 - INFO - Processing period 2022-H2...
2025-07-28 02:28:13,334 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H2_v1_20250728_0214.pkl
2025-07-28 02:28:13,335 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:13,335 - INFO - Feature count: 22
2025-07-28 02:28:13,336 - INFO - Evaluating algorithms with BALANCED data for period 2022-H2...
2025-07-28 02:28:13,336 - INFO - Loading raw training data for period 2022-H2...
2025-07-28 02:28:13,426 - INFO - Loaded 3806 customers for period 2022-H2
2025-07-28 02:28:13,429 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 02:28:13,430 - INFO - Applying BALANCED preprocessing for comparison...
2025-07-28 02:28:13,435 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 02:28:13,435 - INFO - Target distribution: {'NO_PROMOTION': 2854, 'GROWTH_TARGET': 456, 'LOW_ENGAGEMENT': 304, 'INTERVENTION_NEEDED': 190}
2025-07-28 02:28:13,435 - INFO - Current imbalance ratio: 21.01
2025-07-28 02:28:13,436 - INFO - Applying balanced resampling...
2025-07-28 02:28:13,438 - INFO -   NO_PROMOTION: 3025 -> 2854
2025-07-28 02:28:13,439 - INFO -   GROWTH_TARGET: 456 -> 456
2025-07-28 02:28:13,442 - INFO -   LOW_ENGAGEMENT: 181 -> 304
2025-07-28 02:28:13,443 - INFO -   INTERVENTION_NEEDED: 144 -> 190
2025-07-28 02:28:13,445 - INFO - Balanced dataset size: 3804
2025-07-28 02:28:13,447 - INFO - New label distribution:
promo_label
NO_PROMOTION           2854
GROWTH_TARGET           456
LOW_ENGAGEMENT          304
INTERVENTION_NEEDED     190
Name: count, dtype: int64
2025-07-28 02:28:13,456 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:13,456 - INFO - Balanced encoded distribution: [ 456  190  304 2854]
2025-07-28 02:28:13,456 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 02:28:13,457 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:13,457 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:13,459 - INFO - Balanced train set: 3043 samples
2025-07-28 02:28:13,459 - INFO - Balanced test set: 761 samples
2025-07-28 02:28:13,460 - INFO - Test distribution: [ 91  38  61 571]
2025-07-28 02:28:13,460 - INFO - Evaluating trained Random Forest on BALANCED data...
2025-07-28 02:28:13,543 - INFO - Random Forest: Accuracy=0.0802, F1=0.0119, ROC_AUC=0.47399844547654235
2025-07-28 02:28:13,543 - INFO - RF Prediction distribution: [  0   0 761]
2025-07-28 02:28:13,543 - INFO - Actual test distribution: [ 91  38  61 571]
2025-07-28 02:28:13,544 - INFO - Training Decision_Tree on balanced data...
2025-07-28 02:28:13,569 - INFO - Decision_Tree: Accuracy=0.8449, F1=0.8461, ROC_AUC=0.8802383587407517
2025-07-28 02:28:13,569 - INFO - Training Logistic_Regression on balanced data...
2025-07-28 02:28:13,646 - INFO - Logistic_Regression: Accuracy=0.7477, F1=0.7601, ROC_AUC=0.8617569586637528
2025-07-28 02:28:13,647 - INFO - Training K_Nearest_Neighbors on balanced data...
2025-07-28 02:28:13,686 - INFO - K_Nearest_Neighbors: Accuracy=0.8712, F1=0.8535, ROC_AUC=0.9171196394272337
2025-07-28 02:28:13,686 - INFO - Training Naive_Bayes on balanced data...
2025-07-28 02:28:13,696 - INFO - Naive_Bayes: Accuracy=0.7135, F1=0.7161, ROC_AUC=0.8726030576142938
2025-07-28 02:28:13,697 - INFO - Training Support_Vector_Machine on balanced data...
2025-07-28 02:28:14,656 - INFO - Support_Vector_Machine: Accuracy=0.8003, F1=0.8191, ROC_AUC=0.9534729397877366
2025-07-28 02:28:14,657 - INFO - Processing period 2023-H1...
2025-07-28 02:28:14,689 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H1_v1_20250728_0214.pkl
2025-07-28 02:28:14,689 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:14,689 - INFO - Feature count: 22
2025-07-28 02:28:14,690 - INFO - Evaluating algorithms with BALANCED data for period 2023-H1...
2025-07-28 02:28:14,690 - INFO - Loading raw training data for period 2023-H1...
2025-07-28 02:28:14,779 - INFO - Loaded 6646 customers for period 2023-H1
2025-07-28 02:28:14,781 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 02:28:14,783 - INFO - Applying BALANCED preprocessing for comparison...
2025-07-28 02:28:14,793 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 02:28:14,793 - INFO - Target distribution: {'NO_PROMOTION': 4984, 'GROWTH_TARGET': 797, 'LOW_ENGAGEMENT': 531, 'INTERVENTION_NEEDED': 332}
2025-07-28 02:28:14,793 - INFO - Current imbalance ratio: 15.60
2025-07-28 02:28:14,800 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:14,800 - INFO - Balanced encoded distribution: [ 797  339  332 5178]
2025-07-28 02:28:14,801 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 02:28:14,802 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:14,803 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:14,806 - INFO - Balanced train set: 5316 samples
2025-07-28 02:28:14,807 - INFO - Balanced test set: 1330 samples
2025-07-28 02:28:14,807 - INFO - Test distribution: [ 160   68   66 1036]
2025-07-28 02:28:14,808 - INFO - Evaluating trained Random Forest on BALANCED data...
2025-07-28 02:28:14,879 - INFO - Random Forest: Accuracy=0.0496, F1=0.0047, ROC_AUC=0.46696170865299075
2025-07-28 02:28:14,879 - INFO - RF Prediction distribution: [   0    0 1330]
2025-07-28 02:28:14,880 - INFO - Actual test distribution: [ 160   68   66 1036]
2025-07-28 02:28:14,880 - INFO - Training Decision_Tree on balanced data...
2025-07-28 02:28:14,914 - INFO - Decision_Tree: Accuracy=0.8444, F1=0.8303, ROC_AUC=0.8868210038933495
2025-07-28 02:28:14,915 - INFO - Training Logistic_Regression on balanced data...
2025-07-28 02:28:15,049 - INFO - Logistic_Regression: Accuracy=0.6496, F1=0.6886, ROC_AUC=0.8572079003152795
2025-07-28 02:28:15,049 - INFO - Training K_Nearest_Neighbors on balanced data...
2025-07-28 02:28:15,165 - INFO - K_Nearest_Neighbors: Accuracy=0.8519, F1=0.8379, ROC_AUC=0.9175898606250442
2025-07-28 02:28:15,165 - INFO - Training Naive_Bayes on balanced data...
2025-07-28 02:28:15,182 - INFO - Naive_Bayes: Accuracy=0.4940, F1=0.5461, ROC_AUC=0.850951250905484
2025-07-28 02:28:15,183 - INFO - Training Support_Vector_Machine on balanced data...
2025-07-28 02:28:18,599 - INFO - Support_Vector_Machine: Accuracy=0.7338, F1=0.7674, ROC_AUC=0.9367790408260763
2025-07-28 02:28:18,600 - INFO - Processing period 2023-H2...
2025-07-28 02:28:18,639 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H2_v1_20250728_0214.pkl
2025-07-28 02:28:18,639 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:18,640 - INFO - Feature count: 22
2025-07-28 02:28:18,641 - INFO - Evaluating algorithms with BALANCED data for period 2023-H2...
2025-07-28 02:28:18,641 - INFO - Loading raw training data for period 2023-H2...
2025-07-28 02:28:18,854 - INFO - Loaded 15101 customers for period 2023-H2
2025-07-28 02:28:18,856 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 02:28:18,859 - INFO - Applying BALANCED preprocessing for comparison...
2025-07-28 02:28:18,873 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 02:28:18,873 - INFO - Target distribution: {'NO_PROMOTION': 11325, 'GROWTH_TARGET': 1812, 'LOW_ENGAGEMENT': 1208, 'INTERVENTION_NEEDED': 755}
2025-07-28 02:28:18,874 - INFO - Current imbalance ratio: 19.96
2025-07-28 02:28:18,886 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:18,887 - INFO - Balanced encoded distribution: [ 1812   598   755 11936]
2025-07-28 02:28:18,887 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 02:28:18,888 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:18,888 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 02:28:18,895 - INFO - Balanced train set: 12080 samples
2025-07-28 02:28:18,895 - INFO - Balanced test set: 3021 samples
2025-07-28 02:28:18,896 - INFO - Test distribution: [ 362  120  151 2388]
2025-07-28 02:28:18,896 - INFO - Evaluating trained Random Forest on BALANCED data...
2025-07-28 02:28:18,992 - INFO - Random Forest: Accuracy=0.0500, F1=0.0048, ROC_AUC=0.46615996483989763
2025-07-28 02:28:18,992 - INFO - RF Prediction distribution: [   0    0 3021]
2025-07-28 02:28:18,992 - INFO - Actual test distribution: [ 362  120  151 2388]
2025-07-28 02:28:18,993 - INFO - Training Decision_Tree on balanced data...
2025-07-28 02:28:19,091 - INFO - Decision_Tree: Accuracy=0.7984, F1=0.7839, ROC_AUC=0.8072044148680284
2025-07-28 02:28:19,091 - INFO - Training Logistic_Regression on balanced data...
2025-07-28 02:28:19,381 - INFO - Logistic_Regression: Accuracy=0.5038, F1=0.5626, ROC_AUC=0.8292551220271236
2025-07-28 02:28:19,381 - INFO - Training K_Nearest_Neighbors on balanced data...
2025-07-28 02:28:19,559 - INFO - K_Nearest_Neighbors: Accuracy=0.8070, F1=0.7864, ROC_AUC=0.8570241280531428
2025-07-28 02:28:19,559 - INFO - Training Naive_Bayes on balanced data...
2025-07-28 02:28:19,581 - INFO - Naive_Bayes: Accuracy=0.1797, F1=0.1913, ROC_AUC=0.6998475723701185
2025-07-28 02:28:19,582 - INFO - Training Support_Vector_Machine on balanced data...
2025-07-28 02:28:43,028 - INFO - Support_Vector_Machine: Accuracy=0.6418, F1=0.6872, ROC_AUC=0.8915629418256598
2025-07-28 02:28:43,084 - INFO - Results exported to: BALANCED_model_comparison_20250728_0228.csv
2025-07-28 02:28:43,086 - INFO - ============================================================
2025-07-28 02:28:43,087 - INFO - BALANCED COMPARISON COMPLETED SUCCESSFULLY
2025-07-28 02:28:43,087 - INFO - Periods analyzed: 4
2025-07-28 02:28:43,087 - INFO - CSV exported: BALANCED_model_comparison_20250728_0228.csv
2025-07-28 02:28:43,088 - INFO - Log file: BALANCED_model_comparison_20250728_0228.log
2025-07-28 02:28:43,088 - INFO - ============================================================
