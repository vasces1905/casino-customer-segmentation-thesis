2025-07-28 20:24:12,680 - INFO - Logging to: FIXED_model_comparison_20250728_2024.log
2025-07-28 20:24:12,681 - INFO - Starting FIXED comprehensive model comparison...
2025-07-28 20:24:12,681 - INFO - Discovering trained harmonized RF models...
2025-07-28 20:24:12,683 - INFO - Discovered 4 trained periods: ['2022-H1', '2022-H2', '2023-H1', '2023-H2']
2025-07-28 20:24:12,683 - INFO - Processing period 2022-H1...
2025-07-28 20:24:15,555 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H1_v1_20250728_1145.pkl
2025-07-28 20:24:15,556 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:15,558 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:15,559 - INFO - Evaluating algorithms for period 2022-H1...
2025-07-28 20:24:15,559 - INFO - Loading COMPLETE training data for period 2022-H1...
2025-07-28 20:24:16,773 - INFO - Loaded 2326 customers with 23 base features for period 2022-H1
2025-07-28 20:24:16,776 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 20:24:16,777 - INFO - Creating engineered features to match training...
2025-07-28 20:24:16,787 - INFO - Engineered features created. Total columns: 34
2025-07-28 20:24:16,787 - INFO - Complete dataset: 34 total features
2025-07-28 20:24:16,788 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:16,791 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 20:24:16,792 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 20:24:16,793 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 20:24:16,793 - INFO - Created dummy feature: log_avg_bet
2025-07-28 20:24:16,794 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 20:24:16,795 - INFO - Created dummy feature: is_millionaire
2025-07-28 20:24:16,796 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 20:24:16,800 - INFO - Feature matrix shape after alignment: (2326, 31)
2025-07-28 20:24:16,824 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 20:24:16,824 - INFO - Target distribution: {'NO_PROMOTION': 1744, 'GROWTH_TARGET': 279, 'LOW_ENGAGEMENT': 186, 'INTERVENTION_NEEDED': 116}
2025-07-28 20:24:16,825 - INFO - Current imbalance ratio: 27.09
2025-07-28 20:24:16,825 - INFO - Applying balanced resampling...
2025-07-28 20:24:16,827 - INFO -   NO_PROMOTION: 1869 -> 1744
2025-07-28 20:24:16,828 - INFO -   GROWTH_TARGET: 279 -> 279
2025-07-28 20:24:16,829 - INFO -   LOW_ENGAGEMENT: 109 -> 186
2025-07-28 20:24:16,830 - INFO -   INTERVENTION_NEEDED: 69 -> 116
2025-07-28 20:24:16,835 - INFO - Balanced dataset size: 2325
2025-07-28 20:24:16,838 - INFO - New label distribution:
promo_label
NO_PROMOTION           1744
GROWTH_TARGET           279
LOW_ENGAGEMENT          186
INTERVENTION_NEEDED     116
Name: count, dtype: int64
2025-07-28 20:24:16,851 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:16,851 - INFO - Balanced encoded distribution: [ 279  116  186 1744]
2025-07-28 20:24:16,852 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 20:24:16,852 - INFO - Final feature matrix shape: (2325, 31)
2025-07-28 20:24:16,853 - INFO - Expected features: 31
2025-07-28 20:24:16,854 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:16,854 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:20,696 - INFO -  SMOTE applied to training set: 5580 balanced samples
2025-07-28 20:24:20,696 - INFO -  Test set kept imbalanced for realistic evaluation: 465 samples
2025-07-28 20:24:20,696 - INFO - Train set: 5580 samples
2025-07-28 20:24:20,697 - INFO - Test set: 465 samples
2025-07-28 20:24:20,697 - INFO - Test distribution: [ 56  23  37 349]
2025-07-28 20:24:20,697 - INFO - Evaluating trained Random Forest...
2025-07-28 20:24:20,926 - INFO -  RF ROC AUC calculated successfully: 0.5894
2025-07-28 20:24:20,927 - INFO -  RF Predictions - Classes: [2], Distribution: [  0   0 465]
2025-07-28 20:24:20,927 - INFO -  Test Reality - Distribution: [ 56  23  37 349]
2025-07-28 20:24:20,928 - INFO -  Random Forest REALISTIC: Accuracy=0.0796, F1=0.0117, ROC_AUC=0.5893761324752191
2025-07-28 20:24:20,928 - INFO - Training Decision_Tree...
2025-07-28 20:24:21,029 - INFO -  Decision_Tree ROC AUC: 0.9158
2025-07-28 20:24:21,030 - INFO -  Decision_Tree: Accuracy=0.8323, F1=0.8516, ROC_AUC=0.9157989031775067
2025-07-28 20:24:21,030 - INFO - Training Logistic_Regression...
2025-07-28 20:24:21,348 - INFO -  Logistic_Regression ROC AUC: 0.8981
2025-07-28 20:24:21,349 - INFO -  Logistic_Regression: Accuracy=0.7613, F1=0.7861, ROC_AUC=0.8981122083484337
2025-07-28 20:24:21,349 - INFO - Training K_Nearest_Neighbors...
2025-07-28 20:24:21,386 - INFO -  K_Nearest_Neighbors ROC AUC: 0.9337
2025-07-28 20:24:21,386 - INFO -  K_Nearest_Neighbors: Accuracy=0.8237, F1=0.8413, ROC_AUC=0.9336613249172006
2025-07-28 20:24:21,386 - INFO - Training Naive_Bayes...
2025-07-28 20:24:21,406 - INFO -  Naive_Bayes ROC AUC: 0.8737
2025-07-28 20:24:21,407 - INFO -  Naive_Bayes: Accuracy=0.5312, F1=0.5811, ROC_AUC=0.8736844998807067
2025-07-28 20:24:21,407 - INFO - Training Support_Vector_Machine...
2025-07-28 20:24:23,951 - INFO -  Support_Vector_Machine ROC AUC: 0.9555
2025-07-28 20:24:23,952 - INFO -  Support_Vector_Machine: Accuracy=0.7806, F1=0.8097, ROC_AUC=0.9554508780555938
2025-07-28 20:24:23,954 - INFO - Processing period 2022-H2...
2025-07-28 20:24:24,091 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H2_v1_20250728_1201.pkl
2025-07-28 20:24:24,092 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:24,092 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:24,096 - INFO - Evaluating algorithms for period 2022-H2...
2025-07-28 20:24:24,097 - INFO - Loading COMPLETE training data for period 2022-H2...
2025-07-28 20:24:24,186 - INFO - Loaded 3806 customers with 23 base features for period 2022-H2
2025-07-28 20:24:24,189 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 20:24:24,189 - INFO - Creating engineered features to match training...
2025-07-28 20:24:24,194 - INFO - Engineered features created. Total columns: 34
2025-07-28 20:24:24,194 - INFO - Complete dataset: 34 total features
2025-07-28 20:24:24,195 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:24,197 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 20:24:24,197 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 20:24:24,198 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 20:24:24,199 - INFO - Created dummy feature: log_avg_bet
2025-07-28 20:24:24,200 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 20:24:24,201 - INFO - Created dummy feature: is_millionaire
2025-07-28 20:24:24,202 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 20:24:24,206 - INFO - Feature matrix shape after alignment: (3806, 31)
2025-07-28 20:24:24,218 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 20:24:24,219 - INFO - Target distribution: {'NO_PROMOTION': 2854, 'GROWTH_TARGET': 456, 'LOW_ENGAGEMENT': 304, 'INTERVENTION_NEEDED': 190}
2025-07-28 20:24:24,219 - INFO - Current imbalance ratio: 21.01
2025-07-28 20:24:24,220 - INFO - Applying balanced resampling...
2025-07-28 20:24:24,221 - INFO -   NO_PROMOTION: 3025 -> 2854
2025-07-28 20:24:24,223 - INFO -   GROWTH_TARGET: 456 -> 456
2025-07-28 20:24:24,224 - INFO -   LOW_ENGAGEMENT: 181 -> 304
2025-07-28 20:24:24,226 - INFO -   INTERVENTION_NEEDED: 144 -> 190
2025-07-28 20:24:24,231 - INFO - Balanced dataset size: 3804
2025-07-28 20:24:24,233 - INFO - New label distribution:
promo_label
NO_PROMOTION           2854
GROWTH_TARGET           456
LOW_ENGAGEMENT          304
INTERVENTION_NEEDED     190
Name: count, dtype: int64
2025-07-28 20:24:24,241 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:24,241 - INFO - Balanced encoded distribution: [ 456  190  304 2854]
2025-07-28 20:24:24,242 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 20:24:24,242 - INFO - Final feature matrix shape: (3804, 31)
2025-07-28 20:24:24,243 - INFO - Expected features: 31
2025-07-28 20:24:24,243 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:24,244 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:24,288 - INFO -  SMOTE applied to training set: 9132 balanced samples
2025-07-28 20:24:24,289 - INFO -  Test set kept imbalanced for realistic evaluation: 761 samples
2025-07-28 20:24:24,289 - INFO - Train set: 9132 samples
2025-07-28 20:24:24,289 - INFO - Test set: 761 samples
2025-07-28 20:24:24,290 - INFO - Test distribution: [ 91  38  61 571]
2025-07-28 20:24:24,290 - INFO - Evaluating trained Random Forest...
2025-07-28 20:24:24,505 - INFO -  RF ROC AUC calculated successfully: 0.5480
2025-07-28 20:24:24,506 - INFO -  RF Predictions - Classes: [2], Distribution: [  0   0 761]
2025-07-28 20:24:24,506 - INFO -  Test Reality - Distribution: [ 91  38  61 571]
2025-07-28 20:24:24,507 - INFO -  Random Forest REALISTIC: Accuracy=0.0802, F1=0.0119, ROC_AUC=0.5480085323555565
2025-07-28 20:24:24,507 - INFO - Training Decision_Tree...
2025-07-28 20:24:24,636 - INFO -  Decision_Tree ROC AUC: 0.9053
2025-07-28 20:24:24,636 - INFO -  Decision_Tree: Accuracy=0.8068, F1=0.8287, ROC_AUC=0.9052539593145221
2025-07-28 20:24:24,636 - INFO - Training Logistic_Regression...
2025-07-28 20:24:25,029 - INFO -  Logistic_Regression ROC AUC: 0.9155
2025-07-28 20:24:25,030 - INFO -  Logistic_Regression: Accuracy=0.7608, F1=0.7874, ROC_AUC=0.9155307550221045
2025-07-28 20:24:25,030 - INFO - Training K_Nearest_Neighbors...
2025-07-28 20:24:25,074 - INFO -  K_Nearest_Neighbors ROC AUC: 0.9199
2025-07-28 20:24:25,075 - INFO -  K_Nearest_Neighbors: Accuracy=0.7950, F1=0.8181, ROC_AUC=0.9198531899851049
2025-07-28 20:24:25,076 - INFO - Training Naive_Bayes...
2025-07-28 20:24:25,108 - INFO -  Naive_Bayes ROC AUC: 0.8863
2025-07-28 20:24:25,108 - INFO -  Naive_Bayes: Accuracy=0.5453, F1=0.6150, ROC_AUC=0.8863352714003837
2025-07-28 20:24:25,110 - INFO - Training Support_Vector_Machine...
2025-07-28 20:24:31,518 - INFO -  Support_Vector_Machine ROC AUC: 0.9453
2025-07-28 20:24:31,518 - INFO -  Support_Vector_Machine: Accuracy=0.7595, F1=0.7900, ROC_AUC=0.9452560241681786
2025-07-28 20:24:31,519 - INFO - Processing period 2023-H1...
2025-07-28 20:24:31,716 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H1_v1_20250728_1204.pkl
2025-07-28 20:24:31,717 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:31,717 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:31,724 - INFO - Evaluating algorithms for period 2023-H1...
2025-07-28 20:24:31,725 - INFO - Loading COMPLETE training data for period 2023-H1...
2025-07-28 20:24:31,835 - INFO - Loaded 6646 customers with 23 base features for period 2023-H1
2025-07-28 20:24:31,838 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 20:24:31,839 - INFO - Creating engineered features to match training...
2025-07-28 20:24:31,844 - INFO - Engineered features created. Total columns: 34
2025-07-28 20:24:31,844 - INFO - Complete dataset: 34 total features
2025-07-28 20:24:31,845 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:24:31,848 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 20:24:31,848 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 20:24:31,849 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 20:24:31,850 - INFO - Created dummy feature: log_avg_bet
2025-07-28 20:24:31,850 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 20:24:31,851 - INFO - Created dummy feature: is_millionaire
2025-07-28 20:24:31,852 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 20:24:31,857 - INFO - Feature matrix shape after alignment: (6646, 31)
2025-07-28 20:24:31,869 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 20:24:31,869 - INFO - Target distribution: {'NO_PROMOTION': 4984, 'GROWTH_TARGET': 797, 'LOW_ENGAGEMENT': 531, 'INTERVENTION_NEEDED': 332}
2025-07-28 20:24:31,870 - INFO - Current imbalance ratio: 15.60
2025-07-28 20:24:31,879 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:31,879 - INFO - Balanced encoded distribution: [ 797  339  332 5178]
2025-07-28 20:24:31,880 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 20:24:31,880 - INFO - Final feature matrix shape: (6646, 31)
2025-07-28 20:24:31,881 - INFO - Expected features: 31
2025-07-28 20:24:31,881 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:31,881 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:24:31,941 - INFO -  SMOTE applied to training set: 16568 balanced samples
2025-07-28 20:24:31,942 - INFO -  Test set kept imbalanced for realistic evaluation: 1330 samples
2025-07-28 20:24:31,942 - INFO - Train set: 16568 samples
2025-07-28 20:24:31,942 - INFO - Test set: 1330 samples
2025-07-28 20:24:31,943 - INFO - Test distribution: [ 160   68   66 1036]
2025-07-28 20:24:31,943 - INFO - Evaluating trained Random Forest...
2025-07-28 20:24:32,155 - INFO -  RF ROC AUC calculated successfully: 0.5996
2025-07-28 20:24:32,156 - INFO -  RF Predictions - Classes: [2], Distribution: [   0    0 1330]
2025-07-28 20:24:32,156 - INFO -  Test Reality - Distribution: [ 160   68   66 1036]
2025-07-28 20:24:32,156 - INFO -  Random Forest REALISTIC: Accuracy=0.0496, F1=0.0047, ROC_AUC=0.599562266691712
2025-07-28 20:24:32,156 - INFO - Training Decision_Tree...
2025-07-28 20:24:32,482 - INFO -  Decision_Tree ROC AUC: 0.8948
2025-07-28 20:24:32,483 - INFO -  Decision_Tree: Accuracy=0.7857, F1=0.8133, ROC_AUC=0.8947751899586971
2025-07-28 20:24:32,483 - INFO - Training Logistic_Regression...
2025-07-28 20:24:33,952 - INFO -  Logistic_Regression ROC AUC: 0.9148
2025-07-28 20:24:33,953 - INFO -  Logistic_Regression: Accuracy=0.7429, F1=0.7735, ROC_AUC=0.9147907824609229
2025-07-28 20:24:33,953 - INFO - Training K_Nearest_Neighbors...
2025-07-28 20:24:34,053 - INFO -  K_Nearest_Neighbors ROC AUC: 0.8911
2025-07-28 20:24:34,053 - INFO -  K_Nearest_Neighbors: Accuracy=0.7759, F1=0.8010, ROC_AUC=0.8911134243611916
2025-07-28 20:24:34,054 - INFO - Training Naive_Bayes...
2025-07-28 20:24:34,073 - INFO -  Naive_Bayes ROC AUC: 0.8604
2025-07-28 20:24:34,074 - INFO -  Naive_Bayes: Accuracy=0.3887, F1=0.4520, ROC_AUC=0.8604445734000128
2025-07-28 20:24:34,074 - INFO - Training Support_Vector_Machine...
2025-07-28 20:25:02,030 - INFO -  Support_Vector_Machine ROC AUC: 0.9370
2025-07-28 20:25:02,031 - INFO -  Support_Vector_Machine: Accuracy=0.7233, F1=0.7627, ROC_AUC=0.937032720069161
2025-07-28 20:25:02,033 - INFO - Processing period 2023-H2...
2025-07-28 20:25:02,410 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H2_v1_20250728_1206.pkl
2025-07-28 20:25:02,411 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:25:02,411 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:25:02,424 - INFO - Evaluating algorithms for period 2023-H2...
2025-07-28 20:25:02,425 - INFO - Loading COMPLETE training data for period 2023-H2...
2025-07-28 20:25:02,654 - INFO - Loaded 15101 customers with 23 base features for period 2023-H2
2025-07-28 20:25:02,657 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 20:25:02,657 - INFO - Creating engineered features to match training...
2025-07-28 20:25:02,663 - INFO - Engineered features created. Total columns: 34
2025-07-28 20:25:02,663 - INFO - Complete dataset: 34 total features
2025-07-28 20:25:02,664 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 20:25:02,666 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 20:25:02,667 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 20:25:02,667 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 20:25:02,668 - INFO - Created dummy feature: log_avg_bet
2025-07-28 20:25:02,668 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 20:25:02,668 - INFO - Created dummy feature: is_millionaire
2025-07-28 20:25:02,669 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 20:25:02,677 - INFO - Feature matrix shape after alignment: (15101, 31)
2025-07-28 20:25:02,700 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 20:25:02,701 - INFO - Target distribution: {'NO_PROMOTION': 11325, 'GROWTH_TARGET': 1812, 'LOW_ENGAGEMENT': 1208, 'INTERVENTION_NEEDED': 755}
2025-07-28 20:25:02,701 - INFO - Current imbalance ratio: 19.96
2025-07-28 20:25:02,723 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:25:02,723 - INFO - Balanced encoded distribution: [ 1812   598   755 11936]
2025-07-28 20:25:02,724 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 20:25:02,725 - INFO - Final feature matrix shape: (15101, 31)
2025-07-28 20:25:02,725 - INFO - Expected features: 31
2025-07-28 20:25:02,726 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:25:02,726 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 20:25:02,852 - INFO -  SMOTE applied to training set: 38192 balanced samples
2025-07-28 20:25:02,853 - INFO -  Test set kept imbalanced for realistic evaluation: 3021 samples
2025-07-28 20:25:02,853 - INFO - Train set: 38192 samples
2025-07-28 20:25:02,853 - INFO - Test set: 3021 samples
2025-07-28 20:25:02,853 - INFO - Test distribution: [ 362  120  151 2388]
2025-07-28 20:25:02,854 - INFO - Evaluating trained Random Forest...
2025-07-28 20:25:03,087 - INFO -  RF ROC AUC calculated successfully: 0.4523
2025-07-28 20:25:03,088 - INFO -  RF Predictions - Classes: [3], Distribution: [   0    0    0 3021]
2025-07-28 20:25:03,088 - INFO -  Test Reality - Distribution: [ 362  120  151 2388]
2025-07-28 20:25:03,088 - INFO -  Random Forest REALISTIC: Accuracy=0.7905, F1=0.6980, ROC_AUC=0.4523475275453757
2025-07-28 20:25:03,089 - INFO - Training Decision_Tree...
2025-07-28 20:25:04,128 - INFO -  Decision_Tree ROC AUC: 0.8486
2025-07-28 20:25:04,128 - INFO -  Decision_Tree: Accuracy=0.6683, F1=0.7136, ROC_AUC=0.8486040045220504
2025-07-28 20:25:04,129 - INFO - Training Logistic_Regression...
2025-07-28 20:25:08,176 - INFO -  Logistic_Regression ROC AUC: 0.8598
2025-07-28 20:25:08,177 - INFO -  Logistic_Regression: Accuracy=0.4965, F1=0.5488, ROC_AUC=0.8597603210506293
2025-07-28 20:25:08,177 - INFO - Training K_Nearest_Neighbors...
2025-07-28 20:25:09,256 - INFO -  K_Nearest_Neighbors ROC AUC: 0.8348
2025-07-28 20:25:09,256 - INFO -  K_Nearest_Neighbors: Accuracy=0.6978, F1=0.7325, ROC_AUC=0.8348428133536421
2025-07-28 20:25:09,257 - INFO - Training Naive_Bayes...
2025-07-28 20:25:09,311 - INFO -  Naive_Bayes ROC AUC: 0.7110
2025-07-28 20:25:09,316 - INFO -  Naive_Bayes: Accuracy=0.1688, F1=0.1668, ROC_AUC=0.7110175277641773
2025-07-28 20:25:09,323 - INFO - Training Support_Vector_Machine...
2025-07-28 20:27:49,168 - INFO -  Support_Vector_Machine ROC AUC: 0.8873
2025-07-28 20:27:49,168 - INFO -  Support_Vector_Machine: Accuracy=0.6117, F1=0.6602, ROC_AUC=0.8872689437926199
2025-07-28 20:27:49,272 - INFO - Results exported to: FIXED_model_comparison_20250728_2027.csv
2025-07-28 20:27:49,272 - INFO - ============================================================
2025-07-28 20:27:49,272 - INFO - FIXED COMPARISON COMPLETED SUCCESSFULLY
2025-07-28 20:27:49,273 - INFO - Periods analyzed: 4
2025-07-28 20:27:49,273 - INFO - CSV exported: FIXED_model_comparison_20250728_2027.csv
2025-07-28 20:27:49,273 - INFO - Log file: FIXED_model_comparison_20250728_2024.log
2025-07-28 20:27:49,273 - INFO - ============================================================
