2025-07-28 14:30:55,875 - INFO - Logging to: FIXED_model_comparison_20250728_1430.log
2025-07-28 14:30:55,876 - INFO - Starting FIXED comprehensive model comparison...
2025-07-28 14:30:55,876 - INFO - Discovering trained harmonized RF models...
2025-07-28 14:30:55,878 - INFO - Discovered 4 trained periods: ['2022-H1', '2022-H2', '2023-H1', '2023-H2']
2025-07-28 14:30:55,878 - INFO - Processing period 2022-H1...
2025-07-28 14:30:56,816 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H1_v1_20250728_1145.pkl
2025-07-28 14:30:56,816 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:30:56,818 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:30:56,818 - INFO - Evaluating algorithms for period 2022-H1...
2025-07-28 14:30:56,818 - INFO - Loading COMPLETE training data for period 2022-H1...
2025-07-28 14:30:57,439 - INFO - Loaded 2326 customers with 23 base features for period 2022-H1
2025-07-28 14:30:57,441 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 14:30:57,441 - INFO - Creating engineered features to match training...
2025-07-28 14:30:57,447 - INFO - Engineered features created. Total columns: 34
2025-07-28 14:30:57,447 - INFO - Complete dataset: 34 total features
2025-07-28 14:30:57,447 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:30:57,449 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 14:30:57,449 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 14:30:57,450 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 14:30:57,450 - INFO - Created dummy feature: log_avg_bet
2025-07-28 14:30:57,451 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 14:30:57,451 - INFO - Created dummy feature: is_millionaire
2025-07-28 14:30:57,451 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 14:30:57,454 - INFO - Feature matrix shape after alignment: (2326, 31)
2025-07-28 14:30:57,462 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 14:30:57,462 - INFO - Target distribution: {'NO_PROMOTION': 1744, 'GROWTH_TARGET': 279, 'LOW_ENGAGEMENT': 186, 'INTERVENTION_NEEDED': 116}
2025-07-28 14:30:57,463 - INFO - Current imbalance ratio: 27.09
2025-07-28 14:30:57,463 - INFO - Applying balanced resampling...
2025-07-28 14:30:57,464 - INFO -   NO_PROMOTION: 1869 -> 1744
2025-07-28 14:30:57,465 - INFO -   GROWTH_TARGET: 279 -> 279
2025-07-28 14:30:57,466 - INFO -   LOW_ENGAGEMENT: 109 -> 186
2025-07-28 14:30:57,467 - INFO -   INTERVENTION_NEEDED: 69 -> 116
2025-07-28 14:30:57,471 - INFO - Balanced dataset size: 2325
2025-07-28 14:30:57,472 - INFO - New label distribution:
promo_label
NO_PROMOTION           1744
GROWTH_TARGET           279
LOW_ENGAGEMENT          186
INTERVENTION_NEEDED     116
Name: count, dtype: int64
2025-07-28 14:30:57,480 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:30:57,481 - INFO - Balanced encoded distribution: [ 279  116  186 1744]
2025-07-28 14:30:57,481 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 14:30:57,482 - INFO - Final feature matrix shape: (2325, 31)
2025-07-28 14:30:57,482 - INFO - Expected features: 31
2025-07-28 14:30:57,482 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:30:57,483 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:00,430 - INFO -  SMOTE applied to training set: 5580 balanced samples
2025-07-28 14:31:00,430 - INFO -  Test set kept imbalanced for realistic evaluation: 465 samples
2025-07-28 14:31:00,431 - INFO - Train set: 5580 samples
2025-07-28 14:31:00,431 - INFO - Test set: 465 samples
2025-07-28 14:31:00,431 - INFO - Test distribution: [ 56  23  37 349]
2025-07-28 14:31:00,431 - INFO - Evaluating trained Random Forest...
2025-07-28 14:31:00,568 - INFO -  RF ROC AUC calculated successfully: 0.6218
2025-07-28 14:31:00,569 - INFO -  RF Predictions - Classes: [2], Distribution: [  0   0 465]
2025-07-28 14:31:00,569 - INFO -  Test Reality - Distribution: [ 56  23  37 349]
2025-07-28 14:31:00,569 - INFO -  Random Forest REALISTIC: Accuracy=0.0796, F1=0.0117, ROC_AUC=0.621782124685976
2025-07-28 14:31:00,570 - INFO - Training Decision_Tree...
2025-07-28 14:31:00,625 - INFO -  Decision_Tree ROC AUC: 0.8941
2025-07-28 14:31:00,625 - INFO -  Decision_Tree: Accuracy=0.8172, F1=0.8326, ROC_AUC=0.8941200129841027
2025-07-28 14:31:00,626 - INFO - Training Logistic_Regression...
2025-07-28 14:31:00,792 - INFO -  Logistic_Regression ROC AUC: 0.9212
2025-07-28 14:31:00,792 - INFO -  Logistic_Regression: Accuracy=0.7935, F1=0.8132, ROC_AUC=0.9212457322456682
2025-07-28 14:31:00,792 - INFO - Training K_Nearest_Neighbors...
2025-07-28 14:31:00,833 - INFO -  K_Nearest_Neighbors ROC AUC: 0.9308
2025-07-28 14:31:00,834 - INFO -  K_Nearest_Neighbors: Accuracy=0.8323, F1=0.8483, ROC_AUC=0.9308252587149743
2025-07-28 14:31:00,835 - INFO - Training Naive_Bayes...
2025-07-28 14:31:00,851 - INFO -  Naive_Bayes ROC AUC: 0.8788
2025-07-28 14:31:00,852 - INFO -  Naive_Bayes: Accuracy=0.5656, F1=0.6085, ROC_AUC=0.8787520603547713
2025-07-28 14:31:00,852 - INFO - Training Support_Vector_Machine...
2025-07-28 14:31:02,198 - INFO -  Support_Vector_Machine ROC AUC: 0.9578
2025-07-28 14:31:02,199 - INFO -  Support_Vector_Machine: Accuracy=0.8086, F1=0.8308, ROC_AUC=0.9578215737705215
2025-07-28 14:31:02,200 - INFO - Processing period 2022-H2...
2025-07-28 14:31:02,285 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H2_v1_20250728_1201.pkl
2025-07-28 14:31:02,286 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:02,286 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:02,289 - INFO - Evaluating algorithms for period 2022-H2...
2025-07-28 14:31:02,290 - INFO - Loading COMPLETE training data for period 2022-H2...
2025-07-28 14:31:02,424 - INFO - Loaded 3806 customers with 23 base features for period 2022-H2
2025-07-28 14:31:02,426 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 14:31:02,426 - INFO - Creating engineered features to match training...
2025-07-28 14:31:02,430 - INFO - Engineered features created. Total columns: 34
2025-07-28 14:31:02,430 - INFO - Complete dataset: 34 total features
2025-07-28 14:31:02,431 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:02,432 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 14:31:02,433 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 14:31:02,434 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 14:31:02,435 - INFO - Created dummy feature: log_avg_bet
2025-07-28 14:31:02,435 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 14:31:02,436 - INFO - Created dummy feature: is_millionaire
2025-07-28 14:31:02,437 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 14:31:02,440 - INFO - Feature matrix shape after alignment: (3806, 31)
2025-07-28 14:31:02,448 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 14:31:02,448 - INFO - Target distribution: {'NO_PROMOTION': 2854, 'GROWTH_TARGET': 456, 'LOW_ENGAGEMENT': 304, 'INTERVENTION_NEEDED': 190}
2025-07-28 14:31:02,449 - INFO - Current imbalance ratio: 21.01
2025-07-28 14:31:02,450 - INFO - Applying balanced resampling...
2025-07-28 14:31:02,451 - INFO -   NO_PROMOTION: 3025 -> 2854
2025-07-28 14:31:02,453 - INFO -   GROWTH_TARGET: 456 -> 456
2025-07-28 14:31:02,454 - INFO -   LOW_ENGAGEMENT: 181 -> 304
2025-07-28 14:31:02,454 - INFO -   INTERVENTION_NEEDED: 144 -> 190
2025-07-28 14:31:02,458 - INFO - Balanced dataset size: 3804
2025-07-28 14:31:02,459 - INFO - New label distribution:
promo_label
NO_PROMOTION           2854
GROWTH_TARGET           456
LOW_ENGAGEMENT          304
INTERVENTION_NEEDED     190
Name: count, dtype: int64
2025-07-28 14:31:02,465 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:02,467 - INFO - Balanced encoded distribution: [ 456  190  304 2854]
2025-07-28 14:31:02,467 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 14:31:02,468 - INFO - Final feature matrix shape: (3804, 31)
2025-07-28 14:31:02,468 - INFO - Expected features: 31
2025-07-28 14:31:02,469 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:02,469 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:02,498 - INFO -  SMOTE applied to training set: 9132 balanced samples
2025-07-28 14:31:02,499 - INFO -  Test set kept imbalanced for realistic evaluation: 761 samples
2025-07-28 14:31:02,499 - INFO - Train set: 9132 samples
2025-07-28 14:31:02,500 - INFO - Test set: 761 samples
2025-07-28 14:31:02,500 - INFO - Test distribution: [ 91  38  61 571]
2025-07-28 14:31:02,500 - INFO - Evaluating trained Random Forest...
2025-07-28 14:31:02,645 - INFO -  RF ROC AUC calculated successfully: 0.6234
2025-07-28 14:31:02,646 - INFO -  RF Predictions - Classes: [2], Distribution: [  0   0 761]
2025-07-28 14:31:02,646 - INFO -  Test Reality - Distribution: [ 91  38  61 571]
2025-07-28 14:31:02,646 - INFO -  Random Forest REALISTIC: Accuracy=0.0802, F1=0.0119, ROC_AUC=0.6234096176400029
2025-07-28 14:31:02,646 - INFO - Training Decision_Tree...
2025-07-28 14:31:02,723 - INFO -  Decision_Tree ROC AUC: 0.9099
2025-07-28 14:31:02,723 - INFO -  Decision_Tree: Accuracy=0.8226, F1=0.8392, ROC_AUC=0.9099139786837723
2025-07-28 14:31:02,723 - INFO - Training Logistic_Regression...
2025-07-28 14:31:02,978 - INFO -  Logistic_Regression ROC AUC: 0.9087
2025-07-28 14:31:02,979 - INFO -  Logistic_Regression: Accuracy=0.7635, F1=0.7877, ROC_AUC=0.9087043367522987
2025-07-28 14:31:02,979 - INFO - Training K_Nearest_Neighbors...
2025-07-28 14:31:03,050 - INFO -  K_Nearest_Neighbors ROC AUC: 0.9209
2025-07-28 14:31:03,050 - INFO -  K_Nearest_Neighbors: Accuracy=0.8134, F1=0.8312, ROC_AUC=0.9209329520163856
2025-07-28 14:31:03,051 - INFO - Training Naive_Bayes...
2025-07-28 14:31:03,064 - INFO -  Naive_Bayes ROC AUC: 0.8805
2025-07-28 14:31:03,064 - INFO -  Naive_Bayes: Accuracy=0.4744, F1=0.5477, ROC_AUC=0.8805293140297576
2025-07-28 14:31:03,065 - INFO - Training Support_Vector_Machine...
2025-07-28 14:31:06,737 - INFO -  Support_Vector_Machine ROC AUC: 0.9550
2025-07-28 14:31:06,737 - INFO -  Support_Vector_Machine: Accuracy=0.7779, F1=0.8055, ROC_AUC=0.9549748955569974
2025-07-28 14:31:06,738 - INFO - Processing period 2023-H1...
2025-07-28 14:31:06,863 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H1_v1_20250728_1204.pkl
2025-07-28 14:31:06,863 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:06,864 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:06,869 - INFO - Evaluating algorithms for period 2023-H1...
2025-07-28 14:31:06,870 - INFO - Loading COMPLETE training data for period 2023-H1...
2025-07-28 14:31:06,977 - INFO - Loaded 6646 customers with 23 base features for period 2023-H1
2025-07-28 14:31:06,979 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 14:31:06,979 - INFO - Creating engineered features to match training...
2025-07-28 14:31:06,985 - INFO - Engineered features created. Total columns: 34
2025-07-28 14:31:06,986 - INFO - Complete dataset: 34 total features
2025-07-28 14:31:06,987 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:06,989 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 14:31:06,990 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 14:31:06,991 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 14:31:06,992 - INFO - Created dummy feature: log_avg_bet
2025-07-28 14:31:06,992 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 14:31:06,993 - INFO - Created dummy feature: is_millionaire
2025-07-28 14:31:06,993 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 14:31:06,997 - INFO - Feature matrix shape after alignment: (6646, 31)
2025-07-28 14:31:07,010 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 14:31:07,010 - INFO - Target distribution: {'NO_PROMOTION': 4984, 'GROWTH_TARGET': 797, 'LOW_ENGAGEMENT': 531, 'INTERVENTION_NEEDED': 332}
2025-07-28 14:31:07,011 - INFO - Current imbalance ratio: 15.60
2025-07-28 14:31:07,019 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:07,020 - INFO - Balanced encoded distribution: [ 797  339  332 5178]
2025-07-28 14:31:07,021 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 14:31:07,021 - INFO - Final feature matrix shape: (6646, 31)
2025-07-28 14:31:07,022 - INFO - Expected features: 31
2025-07-28 14:31:07,022 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:07,022 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:07,113 - INFO -  SMOTE applied to training set: 16568 balanced samples
2025-07-28 14:31:07,114 - INFO -  Test set kept imbalanced for realistic evaluation: 1330 samples
2025-07-28 14:31:07,114 - INFO - Train set: 16568 samples
2025-07-28 14:31:07,114 - INFO - Test set: 1330 samples
2025-07-28 14:31:07,115 - INFO - Test distribution: [ 160   68   66 1036]
2025-07-28 14:31:07,115 - INFO - Evaluating trained Random Forest...
2025-07-28 14:31:07,263 - INFO -  RF ROC AUC calculated successfully: 0.5996
2025-07-28 14:31:07,263 - INFO -  RF Predictions - Classes: [2], Distribution: [   0    0 1330]
2025-07-28 14:31:07,264 - INFO -  Test Reality - Distribution: [ 160   68   66 1036]
2025-07-28 14:31:07,264 - INFO -  Random Forest REALISTIC: Accuracy=0.0496, F1=0.0047, ROC_AUC=0.599562266691712
2025-07-28 14:31:07,264 - INFO - Training Decision_Tree...
2025-07-28 14:31:07,467 - INFO -  Decision_Tree ROC AUC: 0.8948
2025-07-28 14:31:07,468 - INFO -  Decision_Tree: Accuracy=0.7857, F1=0.8133, ROC_AUC=0.8947751899586971
2025-07-28 14:31:07,468 - INFO - Training Logistic_Regression...
2025-07-28 14:31:08,153 - INFO -  Logistic_Regression ROC AUC: 0.9148
2025-07-28 14:31:08,154 - INFO -  Logistic_Regression: Accuracy=0.7429, F1=0.7735, ROC_AUC=0.9147907824609229
2025-07-28 14:31:08,154 - INFO - Training K_Nearest_Neighbors...
2025-07-28 14:31:08,305 - INFO -  K_Nearest_Neighbors ROC AUC: 0.8911
2025-07-28 14:31:08,306 - INFO -  K_Nearest_Neighbors: Accuracy=0.7759, F1=0.8010, ROC_AUC=0.8911134243611916
2025-07-28 14:31:08,306 - INFO - Training Naive_Bayes...
2025-07-28 14:31:08,324 - INFO -  Naive_Bayes ROC AUC: 0.8604
2025-07-28 14:31:08,324 - INFO -  Naive_Bayes: Accuracy=0.3887, F1=0.4520, ROC_AUC=0.8604445734000128
2025-07-28 14:31:08,324 - INFO - Training Support_Vector_Machine...
2025-07-28 14:31:22,135 - INFO -  Support_Vector_Machine ROC AUC: 0.9370
2025-07-28 14:31:22,135 - INFO -  Support_Vector_Machine: Accuracy=0.7233, F1=0.7627, ROC_AUC=0.937032720069161
2025-07-28 14:31:22,139 - INFO - Processing period 2023-H2...
2025-07-28 14:31:22,514 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H2_v1_20250728_1206.pkl
2025-07-28 14:31:22,515 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:22,515 - INFO - Required features (31): ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:22,524 - INFO - Evaluating algorithms for period 2023-H2...
2025-07-28 14:31:22,524 - INFO - Loading COMPLETE training data for period 2023-H2...
2025-07-28 14:31:22,783 - INFO - Loaded 15101 customers with 23 base features for period 2023-H2
2025-07-28 14:31:22,786 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 14:31:22,786 - INFO - Creating engineered features to match training...
2025-07-28 14:31:22,793 - INFO - Engineered features created. Total columns: 34
2025-07-28 14:31:22,794 - INFO - Complete dataset: 34 total features
2025-07-28 14:31:22,795 - INFO - Required features: ['total_bet_original', 'avg_bet_original', 'bet_volatility_original', 'total_sessions_original', 'log_total_bet', 'log_avg_bet', 'log_bet_volatility', 'log_total_sessions', 'total_bet_robust', 'avg_bet_robust', 'bet_volatility_robust', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better', 'bet_std', 'total_win', 'avg_win', 'avg_loss', 'loss_rate', 'avg_events_per_session', 'game_diversity', 'multi_game_player', 'machine_diversity', 'zone_diversity', 'weekend_preference', 'late_night_player', 'days_since_last_visit', 'session_duration_volatility', 'loss_chasing_score', 'sessions_last_30d', 'bet_trend_ratio']
2025-07-28 14:31:22,801 - INFO - Applying BALANCED preprocessing with feature alignment...
2025-07-28 14:31:22,802 - WARNING - Missing features: ['bet_volatility_original', 'log_avg_bet', 'is_ultra_high_roller', 'is_millionaire', 'is_high_avg_better']
2025-07-28 14:31:22,804 - INFO - Created dummy feature: bet_volatility_original
2025-07-28 14:31:22,806 - INFO - Created dummy feature: log_avg_bet
2025-07-28 14:31:22,808 - INFO - Created dummy feature: is_ultra_high_roller
2025-07-28 14:31:22,809 - INFO - Created dummy feature: is_millionaire
2025-07-28 14:31:22,809 - INFO - Created dummy feature: is_high_avg_better
2025-07-28 14:31:22,820 - INFO - Feature matrix shape after alignment: (15101, 31)
2025-07-28 14:31:22,842 - INFO - Raw label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 14:31:22,843 - INFO - Target distribution: {'NO_PROMOTION': 11325, 'GROWTH_TARGET': 1812, 'LOW_ENGAGEMENT': 1208, 'INTERVENTION_NEEDED': 755}
2025-07-28 14:31:22,843 - INFO - Current imbalance ratio: 19.96
2025-07-28 14:31:22,864 - INFO - Balanced label classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:22,864 - INFO - Balanced encoded distribution: [ 1812   598   755 11936]
2025-07-28 14:31:22,865 - INFO - SUCCESS: Balanced preprocessing completed with 4 classes
2025-07-28 14:31:22,866 - INFO - Final feature matrix shape: (15101, 31)
2025-07-28 14:31:22,867 - INFO - Expected features: 31
2025-07-28 14:31:22,868 - INFO - RF model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:22,868 - INFO - Balanced classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 14:31:23,057 - INFO -  SMOTE applied to training set: 38192 balanced samples
2025-07-28 14:31:23,057 - INFO -  Test set kept imbalanced for realistic evaluation: 3021 samples
2025-07-28 14:31:23,058 - INFO - Train set: 38192 samples
2025-07-28 14:31:23,058 - INFO - Test set: 3021 samples
2025-07-28 14:31:23,059 - INFO - Test distribution: [ 362  120  151 2388]
2025-07-28 14:31:23,059 - INFO - Evaluating trained Random Forest...
2025-07-28 14:31:23,291 - INFO -  RF ROC AUC calculated successfully: 0.4523
2025-07-28 14:31:23,291 - INFO -  RF Predictions - Classes: [3], Distribution: [   0    0    0 3021]
2025-07-28 14:31:23,291 - INFO -  Test Reality - Distribution: [ 362  120  151 2388]
2025-07-28 14:31:23,292 - INFO -  Random Forest REALISTIC: Accuracy=0.7905, F1=0.6980, ROC_AUC=0.4523475275453757
2025-07-28 14:31:23,292 - INFO - Training Decision_Tree...
2025-07-28 14:31:24,154 - INFO -  Decision_Tree ROC AUC: 0.8486
2025-07-28 14:31:24,155 - INFO -  Decision_Tree: Accuracy=0.6683, F1=0.7136, ROC_AUC=0.8486040045220504
2025-07-28 14:31:24,155 - INFO - Training Logistic_Regression...
2025-07-28 14:31:26,426 - INFO -  Logistic_Regression ROC AUC: 0.8598
2025-07-28 14:31:26,426 - INFO -  Logistic_Regression: Accuracy=0.4965, F1=0.5488, ROC_AUC=0.8597603210506293
2025-07-28 14:31:26,427 - INFO - Training K_Nearest_Neighbors...
2025-07-28 14:31:27,010 - INFO -  K_Nearest_Neighbors ROC AUC: 0.8348
2025-07-28 14:31:27,010 - INFO -  K_Nearest_Neighbors: Accuracy=0.6978, F1=0.7325, ROC_AUC=0.8348428133536421
2025-07-28 14:31:27,011 - INFO - Training Naive_Bayes...
2025-07-28 14:31:27,090 - INFO -  Naive_Bayes ROC AUC: 0.7110
2025-07-28 14:31:27,090 - INFO -  Naive_Bayes: Accuracy=0.1688, F1=0.1668, ROC_AUC=0.7110175277641773
2025-07-28 14:31:27,091 - INFO - Training Support_Vector_Machine...
2025-07-28 14:33:38,617 - INFO -  Support_Vector_Machine ROC AUC: 0.8873
2025-07-28 14:33:38,617 - INFO -  Support_Vector_Machine: Accuracy=0.6117, F1=0.6602, ROC_AUC=0.8872689437926199
2025-07-28 14:33:38,716 - INFO - Results exported to: FIXED_model_comparison_20250728_1433.csv
2025-07-28 14:33:38,716 - INFO - ============================================================
2025-07-28 14:33:38,716 - INFO - FIXED COMPARISON COMPLETED SUCCESSFULLY
2025-07-28 14:33:38,716 - INFO - Periods analyzed: 4
2025-07-28 14:33:38,717 - INFO - CSV exported: FIXED_model_comparison_20250728_1433.csv
2025-07-28 14:33:38,717 - INFO - Log file: FIXED_model_comparison_20250728_1430.log
2025-07-28 14:33:38,717 - INFO - ============================================================
