2025-07-28 01:57:44,253 - INFO - Logging to: FINAL_model_comparison_20250728_0157.log
2025-07-28 01:57:44,254 - INFO - Starting FINAL FIXED comprehensive model comparison...
2025-07-28 01:57:44,254 - INFO - Discovering trained harmonized RF models...
2025-07-28 01:57:44,255 - INFO - Discovered 4 trained periods: ['2022-H1', '2022-H2', '2023-H1', '2023-H2']
2025-07-28 01:57:44,255 - INFO - Processing period 2022-H1...
2025-07-28 01:57:44,441 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H1_v1_20250728_0148.pkl
2025-07-28 01:57:44,442 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 01:57:44,452 - INFO - Feature count: 22
2025-07-28 01:57:44,452 - INFO - Evaluating algorithms for period 2022-H1...
2025-07-28 01:57:44,453 - INFO - Loading EXACT training data for period 2022-H1...
2025-07-28 01:57:44,911 - INFO - Loaded 2326 customers for period 2022-H1
2025-07-28 01:57:44,913 - INFO - Label distribution:
promo_label
NO_PROMOTION           1869
GROWTH_TARGET           279
LOW_ENGAGEMENT          109
INTERVENTION_NEEDED      69
Name: count, dtype: int64
2025-07-28 01:57:44,915 - INFO - Label encoding successful
2025-07-28 01:57:44,915 - INFO - Unique labels in data: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:44,915 - INFO - Model expects: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:44,918 - INFO - Evaluating trained Random Forest...
2025-07-28 01:57:44,982 - INFO - Random Forest: Accuracy=0.0644, F1=0.0306, ROC_AUC=0.8479522918539685
2025-07-28 01:57:44,982 - INFO - RF Prediction distribution: [  2   6 458]
2025-07-28 01:57:44,982 - INFO - Actual test distribution: [ 56  14  22 374]
2025-07-28 01:57:44,982 - INFO - Training Decision_Tree...
2025-07-28 01:57:44,991 - INFO - Decision_Tree: Accuracy=0.8197, F1=0.8188, ROC_AUC=0.8569096649695493
2025-07-28 01:57:44,991 - INFO - Training Logistic_Regression...
2025-07-28 01:57:45,392 - INFO - Logistic_Regression: Accuracy=0.8197, F1=0.8304, ROC_AUC=0.9213226259446063
2025-07-28 01:57:45,393 - INFO - Training K_Nearest_Neighbors...
2025-07-28 01:57:48,220 - INFO - K_Nearest_Neighbors: Accuracy=0.8670, F1=0.8516, ROC_AUC=0.9064470043152343
2025-07-28 01:57:48,221 - INFO - Training Naive_Bayes...
2025-07-28 01:57:48,225 - INFO - Naive_Bayes: Accuracy=0.8197, F1=0.7836, ROC_AUC=0.8380202711750215
2025-07-28 01:57:48,225 - INFO - Training Support_Vector_Machine...
2025-07-28 01:57:48,902 - INFO - Support_Vector_Machine: Accuracy=0.8455, F1=0.7771, ROC_AUC=0.9287121653469756
2025-07-28 01:57:48,903 - INFO - Processing period 2022-H2...
2025-07-28 01:57:48,923 - INFO - Successfully loaded RF model from clean_harmonized_rf_2022-H2_v1_20250728_0148.pkl
2025-07-28 01:57:48,923 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 01:57:48,923 - INFO - Feature count: 22
2025-07-28 01:57:48,924 - INFO - Evaluating algorithms for period 2022-H2...
2025-07-28 01:57:48,924 - INFO - Loading EXACT training data for period 2022-H2...
2025-07-28 01:57:48,966 - INFO - Loaded 3806 customers for period 2022-H2
2025-07-28 01:57:48,968 - INFO - Label distribution:
promo_label
NO_PROMOTION           3025
GROWTH_TARGET           456
LOW_ENGAGEMENT          181
INTERVENTION_NEEDED     144
Name: count, dtype: int64
2025-07-28 01:57:48,970 - INFO - Label encoding successful
2025-07-28 01:57:48,970 - INFO - Unique labels in data: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:48,971 - INFO - Model expects: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:48,974 - INFO - Evaluating trained Random Forest...
2025-07-28 01:57:49,064 - INFO - Random Forest: Accuracy=0.0604, F1=0.0398, ROC_AUC=0.8142569585561993
2025-07-28 01:57:49,064 - INFO - RF Prediction distribution: [ 15   9 738]
2025-07-28 01:57:49,064 - INFO - Actual test distribution: [ 91  29  36 606]
2025-07-28 01:57:49,065 - INFO - Training Decision_Tree...
2025-07-28 01:57:49,081 - INFO - Decision_Tree: Accuracy=0.8451, F1=0.8437, ROC_AUC=0.8718172667020736
2025-07-28 01:57:49,082 - INFO - Training Logistic_Regression...
2025-07-28 01:57:49,641 - INFO - Logistic_Regression: Accuracy=0.8281, F1=0.8371, ROC_AUC=0.9172182458457502
2025-07-28 01:57:49,642 - INFO - Training K_Nearest_Neighbors...
2025-07-28 01:57:49,702 - INFO - K_Nearest_Neighbors: Accuracy=0.8504, F1=0.8345, ROC_AUC=0.918082849519182
2025-07-28 01:57:49,702 - INFO - Training Naive_Bayes...
2025-07-28 01:57:49,708 - INFO - Naive_Bayes: Accuracy=0.6260, F1=0.6689, ROC_AUC=0.8529414581291478
2025-07-28 01:57:49,708 - INFO - Training Support_Vector_Machine...
2025-07-28 01:57:51,919 - INFO - Support_Vector_Machine: Accuracy=0.8425, F1=0.7729, ROC_AUC=0.9142395607784467
2025-07-28 01:57:51,920 - INFO - Processing period 2023-H1...
2025-07-28 01:57:51,943 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H1_v1_20250728_0149.pkl
2025-07-28 01:57:51,944 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 01:57:51,944 - INFO - Feature count: 22
2025-07-28 01:57:51,945 - INFO - Evaluating algorithms for period 2023-H1...
2025-07-28 01:57:51,945 - INFO - Loading EXACT training data for period 2023-H1...
2025-07-28 01:57:52,019 - INFO - Loaded 6646 customers for period 2023-H1
2025-07-28 01:57:52,021 - INFO - Label distribution:
promo_label
NO_PROMOTION           5178
GROWTH_TARGET           797
INTERVENTION_NEEDED     339
LOW_ENGAGEMENT          332
Name: count, dtype: int64
2025-07-28 01:57:52,024 - INFO - Label encoding successful
2025-07-28 01:57:52,025 - INFO - Unique labels in data: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:52,025 - INFO - Model expects: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:57:52,031 - INFO - Evaluating trained Random Forest...
2025-07-28 01:57:52,112 - INFO - Random Forest: Accuracy=0.0602, F1=0.0273, ROC_AUC=0.8572970771373358
2025-07-28 01:57:52,112 - INFO - RF Prediction distribution: [   8   16 1306]
2025-07-28 01:57:52,113 - INFO - Actual test distribution: [ 160   68   66 1036]
2025-07-28 01:57:52,113 - INFO - Training Decision_Tree...
2025-07-28 01:57:52,142 - INFO - Decision_Tree: Accuracy=0.8429, F1=0.8427, ROC_AUC=0.8820869222558003
2025-07-28 01:57:52,142 - INFO - Training Logistic_Regression...
2025-07-28 01:57:52,963 - INFO - Logistic_Regression: Accuracy=0.7962, F1=0.8101, ROC_AUC=0.9050213069922166
2025-07-28 01:57:52,963 - INFO - Training K_Nearest_Neighbors...
2025-07-28 01:57:53,049 - INFO - K_Nearest_Neighbors: Accuracy=0.8519, F1=0.8380, ROC_AUC=0.9184530180818024
2025-07-28 01:57:53,050 - INFO - Training Naive_Bayes...
2025-07-28 01:57:53,057 - INFO - Naive_Bayes: Accuracy=0.4925, F1=0.5414, ROC_AUC=0.8571129731923668
2025-07-28 01:57:53,057 - INFO - Training Support_Vector_Machine...
2025-07-28 01:58:00,091 - INFO - Support_Vector_Machine: Accuracy=0.8316, F1=0.7595, ROC_AUC=0.9085035934941328
2025-07-28 01:58:00,093 - INFO - Processing period 2023-H2...
2025-07-28 01:58:00,133 - INFO - Successfully loaded RF model from clean_harmonized_rf_2023-H2_v1_20250728_0149.pkl
2025-07-28 01:58:00,133 - INFO - Model classes: ['GROWTH_TARGET' 'INTERVENTION_NEEDED' 'LOW_ENGAGEMENT' 'NO_PROMOTION']
2025-07-28 01:58:00,134 - INFO - Feature count: 22
2025-07-28 01:58:00,135 - INFO - Evaluating algorithms for period 2023-H2...
2025-07-28 01:58:00,136 - INFO - Loading EXACT training data for period 2023-H2...
2025-07-28 01:58:00,337 - INFO - Loaded 15101 customers for period 2023-H2
2025-07-28 01:58:00,339 - INFO - Label distribution:
promo_label
NO_PROMOTION           11936
GROWTH_TARGET           1812
LOW_ENGAGEMENT           755
INTERVENTION_NEEDED      598
Name: count, dtype: int64
2025-07-28 01:58:00,344 - INFO - Label encoding successful
2025-07-28 01:58:00,345 - INFO - Unique labels in data: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:58:00,345 - INFO - Model expects: ['GROWTH_TARGET', 'INTERVENTION_NEEDED', 'LOW_ENGAGEMENT', 'NO_PROMOTION']
2025-07-28 01:58:00,357 - INFO - Evaluating trained Random Forest...
2025-07-28 01:58:00,461 - INFO - Random Forest: Accuracy=0.2023, F1=0.1221, ROC_AUC=0.8355979792764714
2025-07-28 01:58:00,461 - INFO - RF Prediction distribution: [1551  134 1271   65]
2025-07-28 01:58:00,461 - INFO - Actual test distribution: [ 362  120  151 2388]
2025-07-28 01:58:00,461 - INFO - Training Decision_Tree...
2025-07-28 01:58:00,560 - INFO - Decision_Tree: Accuracy=0.7948, F1=0.7826, ROC_AUC=0.8093226540981405
2025-07-28 01:58:00,560 - INFO - Training Logistic_Regression...
2025-07-28 01:58:02,253 - INFO - Logistic_Regression: Accuracy=0.6875, F1=0.7207, ROC_AUC=0.8716707042433022
2025-07-28 01:58:02,254 - INFO - Training K_Nearest_Neighbors...
2025-07-28 01:58:02,527 - INFO - K_Nearest_Neighbors: Accuracy=0.8064, F1=0.7860, ROC_AUC=0.8578001279815464
2025-07-28 01:58:02,527 - INFO - Training Naive_Bayes...
2025-07-28 01:58:02,554 - INFO - Naive_Bayes: Accuracy=0.1920, F1=0.2095, ROC_AUC=0.7295859199395418
2025-07-28 01:58:02,555 - INFO - Training Support_Vector_Machine...
2025-07-28 01:58:46,772 - INFO - Support_Vector_Machine: Accuracy=0.7865, F1=0.7709, ROC_AUC=0.882133224373925
2025-07-28 01:58:46,820 - INFO - Results exported to: FINAL_model_comparison_20250728_0158.csv
2025-07-28 01:58:46,821 - INFO - ============================================================
2025-07-28 01:58:46,821 - INFO - FINAL COMPARISON COMPLETED SUCCESSFULLY
2025-07-28 01:58:46,821 - INFO - Periods analyzed: 4
2025-07-28 01:58:46,821 - INFO - CSV exported: FINAL_model_comparison_20250728_0158.csv
2025-07-28 01:58:46,822 - INFO - Log file: FINAL_model_comparison_20250728_0157.log
2025-07-28 01:58:46,822 - INFO - ============================================================
